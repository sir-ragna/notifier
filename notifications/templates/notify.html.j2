{% extends "base.html.j2" %}

{% block head %}
<style>
/* Fix example code styling white-space:pre-line; pre-wrap; */
pre { white-space: pre-line; }
</style>
{% endblock head %}
{% block content %}
<a href="{% url 'index' %}">Back to main page</a>
<hr>
<h1>Create a notification</h1>
<hr>
<h2>Code example</h2>
<pre><code id="example-code"></code></pre>
<h2>Manually</h2>
<form action="{% url 'create notification' %}" method="POST" enctype="multipart/form-data">

{{ notification_form.as_p }}
<br>
<button class="btn btn-primary" type="submit">submit</button>
</form>

<script>
let description = document.getElementById('id_description')
let system = document.getElementById('id_system')
let customer = document.getElementById('id_customer')
function updateExampleCode() {
    console.log("hello");
    let example = document.getElementById('example-code');
    let url = window.location;
    example.innerHTML = `Invoke-WebRequest -Uri "${url}" -Method POST -Body @{description='${description.value}';customer='${customer.value}';system="${system.value}"}`;
}
description.addEventListener("input", updateExampleCode);
description.addEventListener("change", updateExampleCode);
system.addEventListener("input", updateExampleCode);
system.addEventListener("change", updateExampleCode);
customer.addEventListener("change", updateExampleCode);
document.addEventListener('DOMContentLoaded', updateExampleCode);
/* Invoke-WebRequest -Uri "http://192.168.0.148:8000/notify" -Method POST -Body @{description='Detected suspicious activity in the log';customer='a2ccb709-c8f3-4df7-b5f5-f8492bb65de8';system="cisco router"} */
</script>

{% endblock content %}